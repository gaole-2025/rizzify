/**
 * ç”Ÿæˆå ä½ç¬¦æ¨¡æ¿å›¾ç‰‡
 * ä½¿ç”¨Canvas APIåˆ›å»ºç®€å•çš„å ä½ç¬¦å›¾ç‰‡
 */

const fs = require('fs');
const path = require('path');
const { createCanvas, loadImage } = require('canvas');

/**
 * åˆ›å»ºå ä½ç¬¦å›¾ç‰‡
 */
async function createPlaceholderImage(filename, outputPath, gender, style) {
  const canvas = createCanvas(1024, 1024);
  const ctx = canvas.getContext('2d');

  // è®¾ç½®èƒŒæ™¯é¢œè‰²
  ctx.fillStyle = gender === 'male' ? '#4A90E2' : '#E91E63';
  ctx.fillRect(0, 0, 1024, 1024);

  // æ·»åŠ æ–‡å­—
  ctx.fillStyle = 'white';
  ctx.font = 'bold 48px Arial, sans-serif';
  ctx.textAlign = 'center';
  ctx.textBaseline = 'middle';

  // ä¸»æ ‡é¢˜
  ctx.fillText(`${gender.toUpperCase()} ${style.toUpperCase()}`, 512, 480);

  // å‰¯æ ‡é¢˜
  ctx.font = '32px Arial, sans-serif';
  ctx.fillText(filename, 512, 540);

  // ä¿å­˜ä¸ºPNGæ–‡ä»¶
  const filePath = path.join(outputPath, filename);
  const buffer = canvas.toBuffer('image/jpeg');
  fs.writeFileSync(filePath, buffer);
  console.log(`âœ… Created placeholder: ${filePath}`);
}

/**
 * ç”Ÿæˆæ‰€æœ‰å ä½ç¬¦å›¾ç‰‡
 */
function generateAllPlaceholders() {
  const basePath = 'public/templates';

  console.log('ğŸ¨ Generating placeholder template images...');

  // Male templates
  const malePath = path.join(basePath, 'male', 'classic');
  if (!fs.existsSync(malePath)) {
    fs.mkdirSync(malePath, { recursive: true });
  }

  for (let i = 1; i <= 5; i++) {
    const filename = `${String(i).padStart(3, '0')}.jpg`;
    createPlaceholderImage(filename, malePath, 'male', 'classic');
  }

  // Female templates
  const femalePath = path.join(basePath, 'female', 'classic');
  if (!fs.existsSync(femalePath)) {
    fs.mkdirSync(femalePath, { recursive: true });
  }

  for (let i = 1; i <= 5; i++) {
    const filename = `${String(i).padStart(3, '0')}.jpg`;
    createPlaceholderImage(filename, femalePath, 'female', 'classic');
  }

  console.log('âœ… All placeholder templates generated successfully!');
  console.log('\nğŸ“‹ Template structure:');
  console.log('public/templates/');
  console.log('â”œâ”€â”€ male/');
  console.log('â”‚   â””â”€â”€ classic/');
  console.log('â”‚       â”œâ”€â”€ 001.jpg');
  console.log('â”‚       â”œâ”€â”€ 002.jpg');
  console.log('â”‚       â”œâ”€â”€ 003.jpg');
  console.log('â”‚       â”œâ”€â”€ 004.jpg');
  console.log('â”‚       â””â”€â”€ 005.jpg');
  console.log('â””â”€â”€ female/');
  console.log('    â””â”€â”€ classic/');
  console.log('        â”œâ”€â”€ 001.jpg');
  console.log('        â”œâ”€â”€ 002.jpg');
  console.log('        â”œâ”€â”€ 003.jpg');
  console.log('        â”œâ”€â”€ 004.jpg');
  console.log('        â””â”€â”€ 005.jpg');
}

generateAllPlaceholders();